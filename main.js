(()=>{let e,t=document.getElementById("new-todo-btn");function l(e,t){this.name=e,this.todo=t}function n(e,t,l,n){this.title=e,this.desc=t,this.date=l,this.priority=n}null===JSON.parse(localStorage.getItem("projects"))||0===JSON.parse(localStorage.getItem("projects")).length?(localStorage.setItem("projects",JSON.stringify([])),e=JSON.parse(localStorage.getItem("projects")),t.style.display="none"):(e=JSON.parse(localStorage.getItem("projects")),t.style.display="block");let d=(e,t)=>{let l=document.getElementById("flash");l.style.display="block",l.textContent=t,"error"===e?l.style.backgroundColor="rgb(128, 0, 0)":"success"===e&&(l.style.backgroundColor="rgb(0, 156, 34)"),setTimeout((function(){l.style.display="none"}),4e3)},o=()=>{if(0!==e.length){t.style.display="block",document.getElementById("e-title").style.display="none",document.querySelectorAll(".proj-div").forEach((e=>e.remove()));let l=document.getElementById("todo-grid");e.forEach((t=>{let n=document.createElement("div");n.className="proj-div",l.appendChild(n);let a=document.createElement("div");a.className="grid3-div",n.appendChild(a);let c=document.createElement("div");a.appendChild(c);let i=document.createElement("h2"),s=document.createTextNode(t.name);i.className="proj-name",i.appendChild(s),a.appendChild(i);let r=document.createElement("button"),m=document.createTextNode("Delete");r.className="delete-proj-btn",r.appendChild(m),a.appendChild(r),r.onclick=function(){if(!0===confirm("Are you sure you want to delete this project?")){let l=[];e.find((e=>{e===t||l.push(e)})),e=[],l.forEach((t=>{e.push(t)})),localStorage.setItem("projects",JSON.stringify(e)),d("success",`Project ${t.name} was deleted`),o()}};let p=document.createElement("div");if(p.className="todo-div",n.appendChild(p),t.todo.length>0){let l=document.createElement("div");l.className="todo-row-info",p.appendChild(l);let n=document.createElement("h3"),a=document.createTextNode("Title");n.className="td-title-info",n.appendChild(a),l.appendChild(n);let c=document.createElement("h3"),i=document.createTextNode("Date");c.className="td-date-info",c.appendChild(i),l.appendChild(c);let s=document.createElement("h3"),r=document.createTextNode("Priority");s.className="td-priority-info",s.appendChild(r),l.appendChild(s);let m=document.createElement("h3"),u=document.createTextNode("Show");m.className="td-priority-info",m.appendChild(u),l.appendChild(m);let h=document.createElement("h3"),y=document.createTextNode("Delete");h.className="td-priority-info",h.appendChild(y),l.appendChild(h);let g=0;t.todo.forEach((l=>{g++;let n=document.createElement("div");n.className="todo-row",p.appendChild(n);let a=document.createElement("h3"),c=document.createTextNode(l.title);a.className="td-title",a.appendChild(c),n.appendChild(a);let i=document.createElement("h3"),s=document.createTextNode(l.date);i.className="td-date",i.appendChild(s),n.appendChild(i);let r=document.createElement("h3"),m=document.createTextNode(l.priority);r.className="td-priority",r.appendChild(m),n.appendChild(r);let u=document.createElement("button"),h=document.createTextNode("Show");u.className="sd-btn",u.appendChild(h),n.appendChild(u);let y=document.createElement("button"),E=document.createTextNode("Delete");y.className="delete-todo-btn",y.appendChild(E),n.appendChild(y),y.onclick=function(){let n=[];t.todo.find((e=>{e===l||n.push(e)})),t.todo=[],n.forEach((e=>{t.todo.push(e)})),localStorage.setItem("projects",JSON.stringify(e)),o(),d("success",`Todo ${l.title} was deleted`)};let v=document.createElement("h3"),f=document.createTextNode(l.desc),C=[];t.name.split(" ").forEach((e=>{let t=e.toLowerCase();C.push(t)}));let N=C.join("-");v.className="td-desc",v.id=`description-${g}-${N}`,v.appendChild(f),n.appendChild(v),v.style.display="none",u.onclick=function(){let e=document.getElementById(`${v.id}`);"none"===e.style.display?(u.textContent="Hide",e.style.display="block"):"block"===e.style.display&&(u.textContent="Show",e.style.display="none")}}))}}))}else t.style.display="none",document.querySelectorAll(".proj-div").forEach((e=>e.remove())),document.getElementById("e-title").style.display="block"};o(),(()=>{let t=document.getElementById("nav-btn"),n=document.getElementById("np-hide"),a=document.getElementById("np-close"),c=document.getElementById("np-submit"),i=document.getElementById("np-input");t.addEventListener("click",(function(){document.getElementById("new-td-hide").style.display="none",n.style.display="block"})),a.addEventListener("click",(function(){n.style.display="none"})),c.addEventListener("click",(function(){if(i.value.trim().length&&0!==i.value.length)if(i.value.length<=30){let t=new l(i.value,[]);e.push(t),localStorage.setItem("projects",JSON.stringify(e)),d("success",`Project ${i.value} was created`),i.value="",o()}else d("error","Project name cannot be longer than 30 characters"),i.value="";else d("error","Project name cannot be empty"),i.value=""}))})(),(()=>{let t=document.getElementById("new-td-hide"),l=document.getElementById("new-todo-btn"),a=document.getElementById("new-td-close"),c=document.getElementById("new-td-submit"),i=document.getElementById("td-title"),s=document.getElementById("td-description"),r=document.getElementById("td-priority"),m=document.getElementById("date-input"),p=document.getElementById("proj-select");l.addEventListener("click",(function(){document.getElementById("np-hide").style.display="none",t.style.display="block",p.options.length=0,e.forEach((e=>{let t=document.createElement("option");t.textContent=e.name,t.value=e.name,p.appendChild(t)}))})),a.addEventListener("click",(function(){t.style.display="none"})),c.addEventListener("click",(function(){i.value.length<=20&&s.value.length<=100&&parseInt(r.value)>=1&&parseInt(r.value)<=10&&i.value.trim().length&&s.value.trim().length&&r.value.trim().length&&m.value.trim().length&&p.value.trim().length?e.forEach((t=>{if(t.name===p.value){let l=new n(i.value,s.value,m.value,parseInt(r.value));t.todo.push(l),localStorage.setItem("projects",JSON.stringify(e)),i.value="",s.value="",r.value="",m.value="",p.value="",o()}})):(i.value="",s.value="",r.value="",m.value="",p.value="",d("error","One or more fields are empty or over the character limit"))}))})()})();